<%- include("partials/header") %>

<section class="thread-card thread-card-wide">
  <h1>Админ меню</h1>
  <p class="muted">Управление пользователями, постами, комментариями и жалобами.</p>
</section>

<section class="thread-card thread-card-wide">
  <h2>Пользователи</h2>
  <% users.forEach((user) => { %>
    <div class="comment-item">
      <strong><%= user.username %></strong> · <span class="muted"><%= user.email %></span> · <span class="muted"><%= user.is_banned ? "Забанен" : "Активен" %></span>
      <% if (!user.is_admin) { %>
        <form action="/admin/users/<%= user.id %>/toggle-ban" method="POST">
          <button type="submit"><%= user.is_banned ? "Разбанить" : "Бан" %></button>
        </form>
      <% } %>
    </div>
  <% }) %>
</section>

<section class="thread-card thread-card-wide">
  <h2>Посты</h2>
  <% polls.forEach((poll) => { %>
    <div class="comment-item">
      <a href="/polls/<%= poll.id %>"><%= poll.title %></a> · <span class="muted"><%= poll.username %></span>
      <form action="/admin/polls/<%= poll.id %>/delete" method="POST">
        <button type="submit">Удалить</button>
      </form>
    </div>
  <% }) %>
</section>

<section class="thread-card thread-card-wide">
  <h2>Комментарии</h2>
  <% comments.forEach((comment) => { %>
    <div class="comment-item">
      <span><%= comment.body %></span> · <span class="muted"><%= comment.username %></span>
      <form action="/admin/comments/<%= comment.id %>/delete" method="POST">
        <button type="submit">Удалить</button>
      </form>
    </div>
  <% }) %>
</section>

<section class="thread-card thread-card-wide">
  <h2>Жалобы</h2>
  <% reports.forEach((report) => { %>
    <div class="comment-item">
      <div><strong>#<%= report.id %></strong> · <span class="muted"><%= report.reporter_name %> · <%= report.status %></span></div>
      <div class="muted">Причина: <%= report.reason %></div>
      <form action="/admin/reports/<%= report.id %>/resolve" method="POST">
        <button type="submit">Отметить обработанной</button>
      </form>
    </div>
  <% }) %>
</section>

<%- include("partials/footer") %>

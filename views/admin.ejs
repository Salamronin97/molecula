<%- include("partials/header") %>

<section class="panel" style="margin-top:24px;">
  <h1>Админ меню</h1>
  <p class="small">Управление пользователями, контентом и жалобами.</p>
</section>

<section class="panel" style="margin-top:14px;">
  <h2>Пользователи</h2>
  <% users.forEach((user) => { %>
    <div class="comment">
      <strong><%= user.username %></strong> · <span class="small"><%= user.email %></span> ·
      <span class="small"><%= user.is_banned ? "Забанен" : "Активен" %></span>
      <% if (!user.is_admin) { %>
        <form action="/admin/users/<%= user.id %>/toggle-ban" method="POST" style="display:inline;">
          <button class="btn <%= user.is_banned ? '' : 'danger' %>" type="submit"><%= user.is_banned ? "Разбанить" : "Бан" %></button>
        </form>
      <% } %>
    </div>
  <% }) %>
</section>

<section class="panel" style="margin-top:14px;">
  <h2>Посты</h2>
  <% polls.forEach((poll) => { %>
    <div class="comment">
      <a href="/polls/<%= poll.id %>"><%= poll.title %></a> · <span class="small"><%= poll.username %></span>
      <form action="/admin/polls/<%= poll.id %>/delete" method="POST" style="display:inline;">
        <button type="submit" class="btn danger">Удалить</button>
      </form>
    </div>
  <% }) %>
</section>

<section class="panel" style="margin-top:14px;">
  <h2>Комментарии</h2>
  <% comments.forEach((comment) => { %>
    <div class="comment">
      <span><%= comment.body %></span> · <span class="small"><%= comment.username %></span>
      <form action="/admin/comments/<%= comment.id %>/delete" method="POST" style="display:inline;">
        <button type="submit" class="btn danger">Удалить</button>
      </form>
    </div>
  <% }) %>
</section>

<section class="panel" style="margin-top:14px;">
  <h2>Жалобы</h2>
  <% reports.forEach((report) => { %>
    <div class="comment">
      <div><strong>#<%= report.id %></strong> · <span class="small"><%= report.reporter_name %> · <%= report.created_at %> · <%= report.status %></span></div>
      <div class="small">Причина: <%= report.reason %></div>
      <form action="/admin/reports/<%= report.id %>/resolve" method="POST" style="display:inline;">
        <button class="btn ghost" type="submit">Отметить обработанной</button>
      </form>
    </div>
  <% }) %>
</section>

<%- include("partials/footer") %>

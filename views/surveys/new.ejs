<%- include("../partials/header") %>

<section class="card form-card">
  <h1>Создание анкеты</h1>

  <div class="template-box">
    <label>Шаблон анкеты
      <select id="template-select">
        <option value="">Без шаблона</option>
        <option value="customer_feedback">Оценка сервиса</option>
        <option value="education_quality">Качество обучения</option>
        <option value="event_feedback">Обратная связь по мероприятию</option>
      </select>
    </label>
    <div class="template-actions">
      <button type="button" class="btn ghost" id="apply-template">Применить шаблон</button>
      <button type="button" class="btn ghost" id="clear-questions">Очистить вопросы</button>
    </div>
  </div>

  <form action="/surveys" method="POST" enctype="multipart/form-data" id="survey-form">
    <label>Название анкеты
      <input type="text" name="title" required maxlength="160" />
    </label>
    <label>Описание
      <textarea name="description" rows="4" required maxlength="4000"></textarea>
    </label>

    <label class="checkline">
      <input type="checkbox" name="has_deadline" value="1" id="has-deadline-toggle" />
      Включить дедлайн (таймер окончания)
    </label>
    <label id="deadline-wrap" style="display:none;">
      Дата завершения
      <input type="datetime-local" name="end_at" id="end-at-input" />
    </label>

    <label>Обложка (фото)
      <input type="file" name="cover" accept="image/*" />
    </label>
    <label>Дополнительные материалы (фото/видео, несколько файлов)
      <input type="file" name="media" accept="image/*,video/*" multiple />
    </label>
    <label class="checkline">
      <input type="checkbox" name="is_anonymous" value="1" />
      Анонимный опрос
    </label>

    <h2>Вопросы</h2>
    <div id="questions"></div>
    <div class="template-actions">
      <button type="button" class="btn ghost" id="add-question">Добавить вопрос</button>
      <button type="submit" class="btn">Опубликовать анкету</button>
    </div>
  </form>
</section>

<template id="question-template">
  <div class="question-builder">
    <label>Текст вопроса
      <input type="text" name="question_texts" required />
    </label>
    <label>Тип вопроса
      <select name="question_types" class="question-type">
        <option value="text">Текстовый ответ</option>
        <option value="single">Один вариант</option>
        <option value="multi">Несколько вариантов</option>
        <option value="scale">Шкала 1-5</option>
      </select>
    </label>
    <label class="checkline">
      <input type="checkbox" name="question_required" checked />
      Обязательный вопрос
    </label>
    <label class="options-block">Варианты ответа (каждый с новой строки)
      <textarea name="question_options" rows="4"></textarea>
    </label>
    <label class="logic-block">
      Переход после ответа (номер вопроса, опционально)
      <input type="number" name="question_next_orders" min="1" />
    </label>
    <button type="button" class="btn ghost remove-question">Удалить вопрос</button>
  </div>
</template>

<%- include("../partials/footer") %>

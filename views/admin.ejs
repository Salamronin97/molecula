<%- include("partials/header") %>

<section class="card">
  <h1>Админ-панель</h1>
  <p class="muted">Управление пользователями, анкетами, комментариями и жалобами.</p>
</section>

<section class="card">
  <h2>Пользователи</h2>
  <% users.forEach((user) => { %>
    <div class="admin-row">
      <span><strong><%= user.username %></strong> · <%= user.email %> · <%= user.is_banned ? "Заблокирован" : "Активен" %></span>
      <% if (!user.is_admin) { %>
        <form action="/admin/users/<%= user.id %>/toggle-ban" method="POST">
          <button type="submit"><%= user.is_banned ? "Разблокировать" : "Заблокировать" %></button>
        </form>
      <% } %>
    </div>
  <% }) %>
</section>

<section class="card">
  <h2>Анкеты</h2>
  <% surveys.forEach((survey) => { %>
    <div class="admin-row">
      <a href="/surveys/<%= survey.id %>"><%= survey.title %></a>
      <form action="/admin/surveys/<%= survey.id %>/delete" method="POST" onsubmit="return confirm('Удалить анкету?')">
        <button type="submit">Удалить</button>
      </form>
    </div>
  <% }) %>
</section>

<section class="card">
  <h2>Комментарии</h2>
  <% comments.forEach((comment) => { %>
    <div class="admin-row">
      <span><%= comment.username %>: <%= comment.body %></span>
      <form action="/admin/comments/<%= comment.id %>/delete" method="POST">
        <button type="submit">Удалить</button>
      </form>
    </div>
  <% }) %>
</section>

<section class="card">
  <h2>Жалобы</h2>
  <% reports.forEach((report) => { %>
    <div class="admin-row">
      <span>#<%= report.id %> · <%= report.reporter_name %> · <%= report.status %> · <%= report.reason %></span>
      <form action="/admin/reports/<%= report.id %>/resolve" method="POST">
        <button type="submit">Обработано</button>
      </form>
    </div>
  <% }) %>
</section>

<%- include("partials/footer") %>
